<%= engine_tag do %>
  <%= render :partial => 'errors', :object => @family, :as => :family if @family %>

  <%= form_tag families_path do %>
    <table>
      <tr><th colspan=4>All fields are required</th></tr>
      <tr>
        <th></th>
        <th>First name</th>
        <th>Last name</th>
        <th>Email</th>
      </tr>
      <% [:father, :mother].each do |p| %>
      <% resident = belongs_to_or_new(@family, p, SummerResidents::Resident) %>
        <tr>
          <td><%= p.capitalize %>:</td>
          <% [:first, :last].each do |n| %>
            <td><%= text_field_tag "#{p}[#{n}_name]", resident.__send__("#{n}_name"), :size => 16 %></td>
          <% end %>
          <td><%= email_field_tag "#{p}[email]", resident.user ? resident.email : "", :size => 16 %></td>
        </tr>
      <% end %>
      <tr>
        <th />
        <th colspan=3><%= submit_tag "Save" %>&emsp;<%= link_to "Cancel", families_path %></th>
      </tr>
    </table>
  <% end %>
<% end %>
